<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>محلات الحجامي | أجود الشالات والطرحات</title>
    <meta name="description" content="محلات الحجامي - أجود أنواع الشالات والطرحات والسجادات التركية ومستلزمات الحج والعمرة في النجف الأشرف">
    <meta name="keywords" content="شالات، طرحات، سجادات تركية، حج، عمرة، النجف، العراق، محلات الحجامي">
    <meta name="author" content="محلات الحجامي">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#8B5CF6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="محلات الحجامي">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="https://firebasestorage.googleapis.com/v0/b/messageemeapp.appspot.com/o/alhijama%2F472208534_122180270408092809_6379164161521111948_n.jpg?alt=media&token=c2381395-7d6c-460c-a197-1a42d05b42c1">
    <link rel="apple-touch-icon" href="https://firebasestorage.googleapis.com/v0/b/messageemeapp.appspot.com/o/alhijama%2F472208534_122180270408092809_6379164161521111948_n.jpg?alt=media&token=c2381395-7d6c-460c-a197-1a42d05b42c1">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- External Resources -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700&display=swap" as="style">
    
    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
<link href="style.css" rel="stylesheet" />
    <style>

    </style>
</head>
<body>
    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Install Prompt -->
    <div class="install-prompt" id="installPrompt">
        <div class="install-content">
            <div class="install-icon">
                <i class="fas fa-mobile-alt"></i>
            </div>
            <div class="install-text">
                <h3>ثبت التطبيق</h3>
                <p>احصل على تجربة أفضل مع تطبيق محلات الحجامي</p>
            </div>
        </div>
        <div class="install-buttons">
            <button class="install-btn primary" onclick="installApp()">
                <i class="fas fa-download"></i>
                تثبيت
            </button>
            <button class="install-btn secondary" onclick="dismissInstall()">
                لاحقاً
            </button>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">ح</div>
                <div class="logo-text">
                    <h1>محلات الحجامي</h1>
                    <p>أجود الشالات والطرحات</p>
                </div>
            </div>
            
            <div class="header-actions">
                <div class="action-btn" onclick="focusSearch()">
                    <i class="fas fa-search"></i>
                </div>
                <div class="action-btn" onclick="toggleCart()">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-badge" id="cartCount">0</span>
                </div>
                <div class="action-btn" onclick="openMessagesModal()" id="messagesBtn">
                    <i class="fas fa-envelope"></i>
                    <span class="message-badge" id="messageCount" style="display: none;">0</span>
                </div>
                <div class="action-btn admin" onclick="toggleAdmin()">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="action-btn" onclick="toggleSidebar()">
                    <i class="fas fa-bars"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Ads Section -->
    <section class="ads-section">
        <div class="ads-container">
            <div class="ads-slider">
                <div class="ads-wrapper" id="adsWrapper">
                    <!-- الإعلانات ستُحمل هنا -->
                </div>
            </div>
        </div>
    </section>

    <!-- Search Section -->
    <section class="search-section">
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="ابحث عن المنتجات المفضلة لديك...">
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content">
        <section class="products-section">
            <div class="section-header">
                <h2 class="section-title">✨ منتجاتنا المميزة</h2>
                <p class="section-subtitle">اكتشف أجود المنتجات بأفضل الأسعار</p>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- المنتجات ستُحمل هنا -->
            </div>
        </section>
    </main>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">القائمة الرئيسية</h2>
            <button class="close-btn" onclick="closeSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Categories Section -->
        <div class="sidebar-section">
            <h3 class="sidebar-section-title">
                <i class="fas fa-th-large"></i>
                التصنيفات
            </h3>
            <div class="sidebar-menu">
                <div class="menu-item" onclick="filterProducts('all')">
                    <i class="fas fa-th"></i>
                    <span>جميع المنتجات</span>
                </div>
                <div class="menu-item" onclick="filterProducts('shawls')">
                    <i class="fas fa-user-tie"></i>
                    <span>الشالات والطرحات</span>
                </div>
                <div class="menu-item" onclick="filterProducts('carpets')">
                    <i class="fas fa-mosque"></i>
                    <span>السجادات التركية</span>
                </div>
                <div class="menu-item" onclick="filterProducts('hajj')">
                    <i class="fas fa-kaaba"></i>
                    <span>مستلزمات الحج والعمرة</span>
                </div>
                <div class="menu-item" onclick="filterProducts('wholesale')">
                    <i class="fas fa-boxes"></i>
                    <span>البيع بالجملة</span>
                </div>
            </div>
        </div>

        <!-- Account Section -->
        <div class="sidebar-section">
            <h3 class="sidebar-section-title">
                <i class="fas fa-user"></i>
                حسابي
            </h3>
            <div class="sidebar-menu">
                <div class="menu-item" onclick="showFavorites()">
                    <i class="fas fa-heart"></i>
                    <span>المفضلة</span>
                </div>
                <div class="menu-item" onclick="showOrders()">
                    <i class="fas fa-clipboard-list"></i>
                    <span>طلباتي</span>
                </div>
                <div class="menu-item" onclick="showOffers()">
                    <i class="fas fa-tags"></i>
                    <span>العروض الخاصة</span>
                </div>
            </div>
        </div>

        <!-- Admin Section -->
        <div class="sidebar-section" id="adminSection" style="display: none;">
            <h3 class="sidebar-section-title">
                <i class="fas fa-crown"></i>
                لوحة الإدارة
            </h3>
            <div class="sidebar-menu">
                <div class="menu-item admin" onclick="openAddProductModal()">
                    <i class="fas fa-plus-circle"></i>
                    <span>إضافة منتج</span>
                </div>
                <div class="menu-item admin" onclick="openAddAdModal()">
                    <i class="fas fa-bullhorn"></i>
                    <span>إضافة إعلان</span>
                </div>
                <div class="menu-item admin" onclick="openManageModal('products')">
                    <i class="fas fa-edit"></i>
                    <span>إدارة المنتجات</span>
                </div>
                <div class="menu-item admin" onclick="openManageModal('ads')">
                    <i class="fas fa-images"></i>
                    <span>إدارة الإعلانات</span>
                </div>
                <div class="menu-item admin" onclick="openMessagesModal()">
                    <i class="fas fa-envelope"></i>
                    <span>رسائل العملاء</span>
                    <span class="message-badge" id="sidebarMessageCount" style="display: none;">0</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-container">
            <div class="nav-item active" onclick="showHome()">
                <i class="fas fa-home nav-icon"></i>
                <span class="nav-label">الرئيسية</span>
            </div>
            <div class="nav-item" onclick="toggleSidebar()">
                <i class="fas fa-th-large nav-icon"></i>
                <span class="nav-label">التصنيفات</span>
            </div>
            <div class="nav-item" onclick="showOffers()">
                <i class="fas fa-tags nav-icon"></i>
                <span class="nav-label">العروض</span>
            </div>
            <div class="nav-item" onclick="showFavorites()">
                <i class="fas fa-heart nav-icon"></i>
                <span class="nav-label">المفضلة</span>
            </div>
        </div>
    </nav>

    <!-- Overlay -->
    <div class="overlay" id="overlay" onclick="closeAll()"></div>

    <!-- Cart Modal -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-shopping-cart"></i>
                    سلة التسوق
                </h3>
                <button class="close-btn" onclick="toggleCart()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="cartItems"></div>
            
            <div style="background: var(--glass); border-radius: var(--radius-lg); padding: var(--space-4); margin: var(--space-4) 0; text-align: center;">
                <div style="color: var(--gray-300); margin-bottom: var(--space-2); font-size: var(--font-size-sm);">المجموع الكلي</div>
                <div style="font-size: var(--font-size-2xl); font-weight: 700; background: var(--success); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    <span id="totalPrice">0</span> د.ع
                </div>
            </div>
            
            <div style="display: flex; gap: var(--space-3);">
                <button class="btn btn-primary" style="flex: 2;" onclick="checkout()">
                    <i class="fab fa-whatsapp"></i>
                    إتمام الطلب
                </button>
                <button class="btn btn-secondary" onclick="clearCart()">
                    <i class="fas fa-trash"></i>
                    إفراغ السلة
                </button>
            </div>
        </div>
    </div>

    <!-- Messages Modal -->
    <div class="modal" id="messagesModal">
        <div class="modal-content" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-envelope"></i>
                    رسائل العملاء
                </h3>
                <button class="close-btn" onclick="closeModal('messagesModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="messages-container" id="messagesContent">
                <!-- الرسائل ستُحمل هنا -->
            </div>
        </div>
    </div>

    <!-- Send Message Modal -->
    <div class="modal" id="sendMessageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-paper-plane"></i>
                    إرسال رسالة للإدارة
                </h3>
                <button class="close-btn" onclick="closeModal('sendMessageModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="sendMessageForm" onsubmit="handleSendMessage(event)">
                <div id="messageProductInfo" style="margin-bottom: var(--space-4);"></div>
                
                <div class="form-group">
                    <label class="form-label">اسمك (اختياري)</label>
                    <input type="text" class="form-input" id="messageSenderName" placeholder="أدخل اسمك">
                </div>
                
                <div class="form-group">
                    <label class="form-label">رسالتك *</label>
                    <textarea class="form-textarea" id="messageText" rows="4" required placeholder="اكتب رسالتك هنا..."></textarea>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-paper-plane"></i>
                    إرسال الرسالة
                </button>
            </form>
        </div>
    </div>

    <!-- Add Product Modal -->
    <div class="modal" id="addProductModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-plus-circle"></i>
                    إضافة منتج جديد
                </h3>
                <button class="close-btn" onclick="closeModal('addProductModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addProductForm" onsubmit="handleAddProduct(event)">
                <div class="form-group">
                    <label class="form-label">اسم المنتج *</label>
                    <input type="text" class="form-input" id="productName" required placeholder="أدخل اسم المنتج">
                </div>
                
                <div class="form-group">
                    <label class="form-label">وصف المنتج *</label>
                    <textarea class="form-textarea" id="productDescription" rows="3" required placeholder="أدخل وصف مفصل للمنتج"></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
                    <div class="form-group">
                        <label class="form-label">السعر (د.ع) *</label>
                        <input type="number" class="form-input" id="productPrice" required placeholder="0">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">السعر الأصلي</label>
                        <input type="number" class="form-input" id="productOriginalPrice" placeholder="للخصومات">
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-3);">
                    <div class="form-group">
                        <label class="form-label">التصنيف *</label>
                        <select class="form-select" id="productCategory" required>
                            <option value="">اختر التصنيف</option>
                            <option value="shawls">الشالات والطرحات</option>
                            <option value="carpets">السجادات التركية</option>
                            <option value="hajj">مستلزمات الحج والعمرة</option>
                            <option value="wholesale">البيع بالجملة</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">العلامة</label>
                        <input type="text" class="form-input" id="productBadge" placeholder="مثل: خصم 25%">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">صور المنتج (حتى 5 صور) *</label>
                    <div class="image-upload-container" id="imageUploadContainer">
                        <div class="image-upload" onclick="addImageUpload()">
                            <i class="fas fa-plus upload-icon"></i>
                            <div style="font-size: var(--font-size-sm); font-weight: 600;">إضافة صورة</div>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-save"></i>
                    حفظ المنتج
                </button>
            </form>
        </div>
    </div>

    <!-- Add Ad Modal -->
    <div class="modal" id="addAdModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">
                    <i class="fas fa-bullhorn"></i>
                    إضافة إعلان جديد
                </h3>
                <button class="close-btn" onclick="closeModal('addAdModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form id="addAdForm" onsubmit="handleAddAd(event)">
                <div class="form-group">
                    <label class="form-label">عنوان الإعلان *</label>
                    <input type="text" class="form-input" id="adTitle" required placeholder="أدخل عنوان الإعلان">
                </div>
                
                <div class="form-group">
                    <label class="form-label">وصف الإعلان *</label>
                    <textarea class="form-textarea" id="adDescription" rows="3" required placeholder="أدخل وصف الإعلان"></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ربط بمنتج (اختياري)</label>
                    <select class="form-select" id="adLinkedProduct">
                        <option value="">بدون ربط</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">صورة الإعلان</label>
                    <div class="image-upload" onclick="document.getElementById('adImageInput').click()">
                        <i class="fas fa-image upload-icon"></i>
                        <div style="font-size: var(--font-size-sm); font-weight: 600;">رفع صورة</div>
                        <input type="file" id="adImageInput" accept="image/*" style="display: none;" onchange="previewAdImage(this)">
                    </div>
                    <div id="adImagePreview"></div>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    <i class="fas fa-save"></i>
                    حفظ الإعلان
                </button>
            </form>
        </div>
    </div>

    <!-- Manage Modal -->
    <div class="modal" id="manageModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3 class="modal-title" id="manageModalTitle">
                    <i class="fas fa-edit"></i>
                    إدارة العناصر
                </h3>
                <button class="close-btn" onclick="closeModal('manageModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="manageContent">
                <!-- المحتوى سيُحمل هنا -->
            </div>
        </div>
    </div>

    <!-- Product Detail Modal -->
    <div class="modal" id="productDetailModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="productDetailTitle">تفاصيل المنتج</h3>
                <button class="close-btn" onclick="closeModal('productDetailModal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="productDetailContent"></div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationText">إشعار</span>
    </div>

    <script>
          </script>
    <script src="app.js"></script>
</body>
</html>
